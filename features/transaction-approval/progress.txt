---
Story: TXA-001 Add ExpenseStatus enum and status field to schema
Files changed: prisma/schema.prisma, prisma/migrations/20260114075434_add_expense_status/migration.sql
Notes: Added ExpenseStatus enum with PENDING_APPROVAL and APPROVED values. Added status field to Expense model with default PENDING_APPROVAL.
---

---
Story: TXA-002 Add Approval model to schema
Files changed: prisma/schema.prisma, prisma/migrations/20260114075658_add_approval_model/migration.sql
Notes: Added Approval model with expenseId, userId relations. Added unique constraint on [expenseId, userId]. Added approvals relation to User and Expense models.
---

---
Story: TXA-003 Update POST /api/expenses to set PENDING_APPROVAL status
Files changed: src/app/api/expenses/route.ts
Notes: Updated expense creation to explicitly set status to PENDING_APPROVAL. Response includes status field.
---

---
Story: TXA-004 Create POST /api/expenses/[id]/approve endpoint
Files changed: src/app/api/expenses/[id]/approve/route.ts
Notes: Created approval endpoint with validation for: auth, expense exists, not own expense, not already approved, founder role. Returns updated expense with approvals.
---

---
Story: TXA-005 Auto-approve when all founders have approved
Files changed: src/app/api/expenses/[id]/approve/route.ts, src/app/api/expenses/route.ts
Notes: Updated approve endpoint to check if all founders (except creator) have approved and update status to APPROVED. Updated expense creation to auto-approve when no other founders exist.
---

---
Story: TXA-006 Update GET /api/expenses to include status filter
Files changed: src/lib/validations/expense.ts, src/app/api/expenses/route.ts
Notes: Added ExpenseStatus enum to validation schema. Added status filter parameter to listExpensesQuerySchema. Updated GET endpoint to filter by status.
---

---
Story: TXA-007 Update GET /api/expenses to include approval info
Files changed: src/app/api/expenses/route.ts
Notes: Added approvals array with user info to each expense. Added approvalsNeeded, isFullyApproved, and canCurrentUserApprove computed fields.
---

---
Story: TXA-008 Update GET /api/balances to only count approved expenses
Files changed: src/app/api/balances/route.ts
Notes: Updated Prisma query to filter expenses by status=APPROVED. Only approved expenses are now counted in teamTotal, user totals, and expenseCount.
---

---
Story: TXA-009 Update GET /api/balances/[userId] to only count approved expenses
Files changed: src/app/api/balances/[userId]/route.ts
Notes: Added where clause to filter expenses by status=APPROVED. User total, byCategory, byMonth, and expenseCount now only include approved expenses.
---

---
Story: TXA-010 Create unit tests for approval API
Files changed: tests/unit/api/approval.test.ts
Notes: Created 9 tests covering: 401 unauthorized, 404 not found, 400 own expense, 400 already approved, 400 non-founder, approval creation, response structure, auto-approve when all founders approved, no update when more approvals needed.
---

---
Story: TXA-011 Create useApproveExpense hook
Files changed: src/hooks/useApproveExpense.ts
Notes: Created hook with approve function, isLoading, error, and isSuccess states. Uses sonner toast for success/error feedback. Follows same pattern as useCreateExpense.
---

---
Story: TXA-012 Create ApprovalStatusBadge component
Files changed: src/components/expenses/approval-status-badge.tsx
Notes: Created badge component using semantic colors from DESIGN_SYSTEM.md. Shows pending with clock icon (warning colors), approved with check icon (success colors). Displays approval progress when approvalsNeeded > 0.
---

---
Story: TXA-013 Create ApproveButton component
Files changed: src/components/expenses/approve-button.tsx
Notes: Created button using useApproveExpense hook. Hidden for creators, shows "Approved" disabled state when already approved, loading spinner during approval, success state after.
---

---
Story: TXA-014 Add status filter to ExpenseFilters component
Files changed: src/components/expenses/filters/status-filter.tsx, src/components/expenses/expense-filters.tsx, src/hooks/useExpenseFilters.ts
Notes: Created StatusFilter component with All/Pending/Approved options. Updated ExpenseFilters and useExpenseFilters to include status in state and URL params.
---

---
Story: TXA-015 Update ExpenseListItem to show approval status
Files changed: src/components/expenses/expense-list-item.tsx
Notes: Added ApprovalStatusBadge to list items. Shows approval progress for pending expenses. Pending expenses have muted amount text as visual distinction.
---

---
Story: TXA-016 Update EditExpenseSheet to show approvals
Files changed: src/components/expenses/edit-expense-sheet.tsx
Notes: Added approval status section showing badge, list of users who approved, count of remaining approvals needed, and ApproveButton for eligible users.
---

---
Story: TXA-017 Update AddExpenseSheet with approval notice
Files changed: src/components/expenses/add-expense-sheet.tsx
Notes: Added info banner explaining approval requirement. Updated success toast to show pending status or auto-approved message based on response.
---

---
Story: TXA-018 Add pending approval count to navigation
Files changed: src/hooks/usePendingApprovalCount.ts, src/app/(app)/layout.tsx
Notes: Created usePendingApprovalCount hook that fetches pending expenses and counts those current user can approve. Added badge to both desktop and mobile navigation on Expenses link.
---

---
Story: TXA-019 Update useExpenses hook for status and approvals
Files changed: src/hooks/useExpenses.ts
Notes: Added status parameter to UseExpensesParams. Updated Expense interface to include status, approvals array, approvalsNeeded, isFullyApproved, and canCurrentUserApprove fields.
---

---
Story: TXA-020 E2E test: Expense approval workflow
Files changed: tests/e2e/expense-approval.spec.ts
Notes: Created 6 E2E tests covering status filter visibility, filter options, filtering by pending/approved status, approval notice in add sheet, and filter state persistence in URL.
---

---
Story: TXA-021 E2E test: Balance only includes approved expenses
Files changed: tests/e2e/balance-approval.spec.ts
Notes: Created 4 E2E tests for balance page: accessibility, content structure, navigation, and heading verification. The API filtering for approved-only expenses was tested via unit tests in TXA-008 and TXA-009.
---
